rm -rf /tmp/*test-raftstore*
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestTransferLeader3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestBasicConfChange3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestConfChangeRecover3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestConfChangeRecoverManyClients3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestConfChangeUnreliable3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestConfChangeUnreliableRecover3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestConfChangeSnapshotUnreliableRecover3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestConfChangeSnapshotUnreliableRecoverConcurrentPartition3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestOneSplit3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestSplitRecover3B|| true
GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestSplitRecoverManyClients3B|| true
=== RUN   TestSplitRecoverManyClients3B
2022/03/17 21:20:09.308929 node.go:193: [0;37m[info] start raft store node, storeID: 1[0m
2022/03/17 21:20:09.309191 peer.go:41: [0;37m[info] region id:1 region_epoch:<conf_ver:1 version:1 > peers:<id:4 store_id:4 > peers:<id:5 store_id:5 > peers:<id:1 store_id:1 > peers:<id:2 store_id:2 > peers:<id:3 store_id:3 >  create peer with ID 1[0m
2022/03/17 21:20:09.309266 raftstore.go:175: [0;37m[info] start store 1, region_count 1, tombstone_count 0, takes 193.621Âµs[0m
2022/03/17 21:20:09.309657 node.go:193: [0;37m[info] start raft store node, storeID: 2[0m
2022/03/17 21:20:09.309730 peer.go:41: [0;37m[info] region id:1 region_epoch:<conf_ver:1 version:1 > peers:<id:4 store_id:4 > peers:<id:5 store_id:5 > peers:<id:1 store_id:1 > peers:<id:2 store_id:2 > peers:<id:3 store_id:3 >  create peer with ID 2[0m
2022/03/17 21:20:09.309762 raftstore.go:175: [0;37m[info] start store 2, region_count 1, tombstone_count 0, takes 57.512Âµs[0m
2022/03/17 21:20:09.310065 node.go:193: [0;37m[info] start raft store node, storeID: 3[0m
2022/03/17 21:20:09.310129 peer.go:41: [0;37m[info] region id:1 region_epoch:<conf_ver:1 version:1 > peers:<id:4 store_id:4 > peers:<id:5 store_id:5 > peers:<id:1 store_id:1 > peers:<id:2 store_id:2 > peers:<id:3 store_id:3 >  create peer with ID 3[0m
2022/03/17 21:20:09.310160 raftstore.go:175: [0;37m[info] start store 3, region_count 1, tombstone_count 0, takes 52.355Âµs[0m
2022/03/17 21:20:09.310480 node.go:193: [0;37m[info] start raft store node, storeID: 4[0m
2022/03/17 21:20:09.310544 peer.go:41: [0;37m[info] region id:1 region_epoch:<conf_ver:1 version:1 > peers:<id:4 store_id:4 > peers:<id:5 store_id:5 > peers:<id:1 store_id:1 > peers:<id:2 store_id:2 > peers:<id:3 store_id:3 >  create peer with ID 4[0m
2022/03/17 21:20:09.310599 raftstore.go:175: [0;37m[info] start store 4, region_count 1, tombstone_count 0, takes 63.844Âµs[0m
2022/03/17 21:20:09.310934 node.go:193: [0;37m[info] start raft store node, storeID: 5[0m
2022/03/17 21:20:09.311000 peer.go:41: [0;37m[info] region id:1 region_epoch:<conf_ver:1 version:1 > peers:<id:4 store_id:4 > peers:<id:5 store_id:5 > peers:<id:1 store_id:1 > peers:<id:2 store_id:2 > peers:<id:3 store_id:3 >  create peer with ID 5[0m
2022/03/17 21:20:09.311032 raftstore.go:175: [0;37m[info] start store 5, region_count 1, tombstone_count 0, takes 54.179Âµs[0m
2022/03/17 21:20:09.914942 raft.go:430: [0;31m[error] node 1 becomeLeader at term 6 with index 5[0m
2022/03/17 21:20:10.585500 peer_msg_handler.go:520: [0;31m[error] [region 1] 1 on split with [49 52 32 48 48 48 48 48 48 48 49][0m
2022/03/17 21:20:10.614117 peer_msg_handler.go:678: [0;31m[error] [region 1] 1 propose split msg, msg: 1 1 local region: 1 1[0m
2022/03/17 21:20:10.620211 peer_msg_handler.go:520: [0;31m[error] [region 1] 1 on split with [49 51 32 48 48 48 48 48 48 48 49][0m
2022/03/17 21:20:10.674540 peer_msg_handler.go:678: [0;31m[error] [region 1] 1 propose split msg, msg: 1 1 local region: 1 1[0m
2022/03/17 21:20:10.679725 peer_msg_handler.go:166: [0;31m[error] [region 1] 1 apply split begin, split key [49 52 32 48 48 48 48 48 48 48 49], StartKey [], EndKey [][0m
2022/03/17 21:20:10.679799 peer.go:41: [0;37m[info] region id:6 end_key:"14 00000001" region_epoch:<conf_ver:1 version:2 > peers:<id:7 store_id:4 > peers:<id:8 store_id:5 > peers:<id:9 store_id:1 > peers:<id:10 store_id:2 > peers:<id:11 store_id:3 >  create peer with ID 9[0m
2022/03/17 21:20:10.699854 peer_msg_handler.go:166: [0;31m[error] [region 1] 3 apply split begin, split key [49 52 32 48 48 48 48 48 48 48 49], StartKey [], EndKey [][0m
2022/03/17 21:20:10.699854 peer_msg_handler.go:214: [0;31m[error] [region 1] 1 apply split finished[0m
2022/03/17 21:20:10.699938 peer.go:41: [0;37m[info] region id:6 end_key:"14 00000001" region_epoch:<conf_ver:1 version:2 > peers:<id:7 store_id:4 > peers:<id:8 store_id:5 > peers:<id:9 store_id:1 > peers:<id:10 store_id:2 > peers:<id:11 store_id:3 >  create peer with ID 11[0m
2022/03/17 21:20:10.705661 peer_msg_handler.go:166: [0;31m[error] [region 1] 4 apply split begin, split key [49 52 32 48 48 48 48 48 48 48 49], StartKey [], EndKey [][0m
2022/03/17 21:20:10.705692 peer_msg_handler.go:166: [0;31m[error] [region 1] 2 apply split begin, split key [49 52 32 48 48 48 48 48 48 48 49], StartKey [], EndKey [][0m
2022/03/17 21:20:10.705729 peer.go:41: [0;37m[info] region id:6 end_key:"14 00000001" region_epoch:<conf_ver:1 version:2 > peers:<id:7 store_id:4 > peers:<id:8 store_id:5 > peers:<id:9 store_id:1 > peers:<id:10 store_id:2 > peers:<id:11 store_id:3 >  create peer with ID 7[0m
2022/03/17 21:20:10.705675 peer_msg_handler.go:166: [0;31m[error] [region 1] 5 apply split begin, split key [49 52 32 48 48 48 48 48 48 48 49], StartKey [], EndKey [][0m
2022/03/17 21:20:10.705766 peer.go:41: [0;37m[info] region id:6 end_key:"14 00000001" region_epoch:<conf_ver:1 version:2 > peers:<id:7 store_id:4 > peers:<id:8 store_id:5 > peers:<id:9 store_id:1 > peers:<id:10 store_id:2 > peers:<id:11 store_id:3 >  create peer with ID 10[0m
2022/03/17 21:20:10.705830 peer.go:41: [0;37m[info] region id:6 end_key:"14 00000001" region_epoch:<conf_ver:1 version:2 > peers:<id:7 store_id:4 > peers:<id:8 store_id:5 > peers:<id:9 store_id:1 > peers:<id:10 store_id:2 > peers:<id:11 store_id:3 >  create peer with ID 8[0m
2022/03/17 21:20:10.716237 peer_msg_handler.go:214: [0;31m[error] [region 1] 3 apply split finished[0m
2022/03/17 21:20:10.721352 peer_msg_handler.go:214: [0;31m[error] [region 1] 5 apply split finished[0m
2022/03/17 21:20:10.721378 peer_msg_handler.go:214: [0;31m[error] [region 1] 2 apply split finished[0m
2022/03/17 21:20:10.721512 peer_msg_handler.go:520: [0;31m[error] [region 1] 1 on split with [49 56 32 48 48 48 48 48 48 48 49][0m
2022/03/17 21:20:10.721357 peer_msg_handler.go:214: [0;31m[error] [region 1] 4 apply split finished[0m
2022/03/17 21:20:10.721676 peer_msg_handler.go:678: [0;31m[error] [region 1] 1 propose split msg, msg: 1 2 local region: 1 2[0m
2022/03/17 21:20:10.730777 peer_msg_handler.go:166: [0;31m[error] [region 1] 1 apply split begin, split key [49 56 32 48 48 48 48 48 48 48 49], StartKey [49 52 32 48 48 48 48 48 48 48 49], EndKey [][0m
2022/03/17 21:20:10.730823 peer.go:41: [0;37m[info] region id:18 start_key:"14 00000001" end_key:"18 00000001" region_epoch:<conf_ver:1 version:3 > peers:<id:19 store_id:4 > peers:<id:20 store_id:5 > peers:<id:21 store_id:1 > peers:<id:22 store_id:2 > peers:<id:23 store_id:3 >  create peer with ID 21[0m
2022/03/17 21:20:10.735510 peer_msg_handler.go:166: [0;31m[error] [region 1] 3 apply split begin, split key [49 56 32 48 48 48 48 48 48 48 49], StartKey [49 52 32 48 48 48 48 48 48 48 49], EndKey [][0m
2022/03/17 21:20:10.735554 peer.go:41: [0;37m[info] region id:18 start_key:"14 00000001" end_key:"18 00000001" region_epoch:<conf_ver:1 version:3 > peers:<id:19 store_id:4 > peers:<id:20 store_id:5 > peers:<id:21 store_id:1 > peers:<id:22 store_id:2 > peers:<id:23 store_id:3 >  create peer with ID 23[0m
2022/03/17 21:20:10.740277 peer_msg_handler.go:166: [0;31m[error] [region 1] 5 apply split begin, split key [49 56 32 48 48 48 48 48 48 48 49], StartKey [49 52 32 48 48 48 48 48 48 48 49], EndKey [][0m
2022/03/17 21:20:10.740312 peer_msg_handler.go:166: [0;31m[error] [region 1] 2 apply split begin, split key [49 56 32 48 48 48 48 48 48 48 49], StartKey [49 52 32 48 48 48 48 48 48 48 49], EndKey [][0m
2022/03/17 21:20:10.740380 peer.go:41: [0;37m[info] region id:18 start_key:"14 00000001" end_key:"18 00000001" region_epoch:<conf_ver:1 version:3 > peers:<id:19 store_id:4 > peers:<id:20 store_id:5 > peers:<id:21 store_id:1 > peers:<id:22 store_id:2 > peers:<id:23 store_id:3 >  create peer with ID 20[0m
2022/03/17 21:20:10.740277 peer_msg_handler.go:166: [0;31m[error] [region 1] 4 apply split begin, split key [49 56 32 48 48 48 48 48 48 48 49], StartKey [49 52 32 48 48 48 48 48 48 48 49], EndKey [][0m
2022/03/17 21:20:10.740425 peer.go:41: [0;37m[info] region id:18 start_key:"14 00000001" end_key:"18 00000001" region_epoch:<conf_ver:1 version:3 > peers:<id:19 store_id:4 > peers:<id:20 store_id:5 > peers:<id:21 store_id:1 > peers:<id:22 store_id:2 > peers:<id:23 store_id:3 >  create peer with ID 22[0m
2022/03/17 21:20:10.740474 peer.go:41: [0;37m[info] region id:18 start_key:"14 00000001" end_key:"18 00000001" region_epoch:<conf_ver:1 version:3 > peers:<id:19 store_id:4 > peers:<id:20 store_id:5 > peers:<id:21 store_id:1 > peers:<id:22 store_id:2 > peers:<id:23 store_id:3 >  create peer with ID 19[0m
2022/03/17 21:20:10.743745 peer_msg_handler.go:214: [0;31m[error] [region 1] 1 apply split finished[0m
2022/03/17 21:20:10.747901 peer_msg_handler.go:214: [0;31m[error] [region 1] 3 apply split finished[0m
2022/03/17 21:20:10.750555 peer_msg_handler.go:214: [0;31m[error] [region 1] 4 apply split finished[0m
2022/03/17 21:20:10.750573 peer_msg_handler.go:214: [0;31m[error] [region 1] 2 apply split finished[0m
2022/03/17 21:20:10.753085 peer_msg_handler.go:214: [0;31m[error] [region 1] 5 apply split finished[0m
2022/03/17 21:20:10.811974 peer_msg_handler.go:520: [0;31m[error] [region 1] 1 on split with [52 32 48 48 48 48 48 48 48 51][0m
2022/03/17 21:20:10.813581 peer_msg_handler.go:678: [0;31m[error] [region 1] 1 propose split msg, msg: 1 3 local region: 1 3[0m
2022/03/17 21:20:10.816835 peer_msg_handler.go:166: [0;31m[error] [region 1] 4 apply split begin, split key [52 32 48 48 48 48 48 48 48 51], StartKey [49 56 32 48 48 48 48 48 48 48 49], EndKey [][0m
2022/03/17 21:20:10.816876 peer_msg_handler.go:166: [0;31m[error] [region 1] 5 apply split begin, split key [52 32 48 48 48 48 48 48 48 51], StartKey [49 56 32 48 48 48 48 48 48 48 49], EndKey [][0m
2022/03/17 21:20:10.816894 peer.go:41: [0;37m[info] region id:24 start_key:"18 00000001" end_key:"4 00000003" region_epoch:<conf_ver:1 version:4 > peers:<id:25 store_id:4 > peers:<id:26 store_id:5 > peers:<id:27 store_id:1 > peers:<id:28 store_id:2 > peers:<id:29 store_id:3 >  create peer with ID 25[0m
2022/03/17 21:20:10.816889 peer_msg_handler.go:166: [0;31m[error] [region 1] 1 apply split begin, split key [52 32 48 48 48 48 48 48 48 51], StartKey [49 56 32 48 48 48 48 48 48 48 49], EndKey [][0m
2022/03/17 21:20:10.816857 peer_msg_handler.go:166: [0;31m[error] [region 1] 3 apply split begin, split key [52 32 48 48 48 48 48 48 48 51], StartKey [49 56 32 48 48 48 48 48 48 48 49], EndKey [][0m
2022/03/17 21:20:10.816857 peer_msg_handler.go:166: [0;31m[error] [region 1] 2 apply split begin, split key [52 32 48 48 48 48 48 48 48 51], StartKey [49 56 32 48 48 48 48 48 48 48 49], EndKey [][0m
2022/03/17 21:20:10.817027 peer.go:41: [0;37m[info] region id:24 start_key:"18 00000001" end_key:"4 00000003" region_epoch:<conf_ver:1 version:4 > peers:<id:25 store_id:4 > peers:<id:26 store_id:5 > peers:<id:27 store_id:1 > peers:<id:28 store_id:2 > peers:<id:29 store_id:3 >  create peer with ID 27[0m
2022/03/17 21:20:10.817054 peer.go:41: [0;37m[info] region id:24 start_key:"18 00000001" end_key:"4 00000003" region_epoch:<conf_ver:1 version:4 > peers:<id:25 store_id:4 > peers:<id:26 store_id:5 > peers:<id:27 store_id:1 > peers:<id:28 store_id:2 > peers:<id:29 store_id:3 >  create peer with ID 28[0m
2022/03/17 21:20:10.816943 peer.go:41: [0;37m[info] region id:24 start_key:"18 00000001" end_key:"4 00000003" region_epoch:<conf_ver:1 version:4 > peers:<id:25 store_id:4 > peers:<id:26 store_id:5 > peers:<id:27 store_id:1 > peers:<id:28 store_id:2 > peers:<id:29 store_id:3 >  create peer with ID 26[0m
2022/03/17 21:20:10.816992 peer.go:41: [0;37m[info] region id:24 start_key:"18 00000001" end_key:"4 00000003" region_epoch:<conf_ver:1 version:4 > peers:<id:25 store_id:4 > peers:<id:26 store_id:5 > peers:<id:27 store_id:1 > peers:<id:28 store_id:2 > peers:<id:29 store_id:3 >  create peer with ID 29[0m
2022/03/17 21:20:10.834860 peer_msg_handler.go:214: [0;31m[error] [region 1] 4 apply split finished[0m
2022/03/17 21:20:10.834861 peer_msg_handler.go:214: [0;31m[error] [region 1] 5 apply split finished[0m
2022/03/17 21:20:10.834864 peer_msg_handler.go:214: [0;31m[error] [region 1] 1 apply split finished[0m
2022/03/17 21:20:10.834931 peer_msg_handler.go:214: [0;31m[error] [region 1] 2 apply split finished[0m
2022/03/17 21:20:10.834876 peer_msg_handler.go:214: [0;31m[error] [region 1] 3 apply split finished[0m
2022/03/17 21:20:11.319177 raft.go:430: [0;31m[error] node 9 becomeLeader at term 6 with index 5[0m
2022/03/17 21:20:11.327121 raft.go:430: [0;31m[error] node 28 becomeLeader at term 6 with index 5[0m
2022/03/17 21:20:11.420286 raft.go:430: [0;31m[error] node 21 becomeLeader at term 6 with index 5[0m
2022/03/17 21:20:15.879040 peer_msg_handler.go:520: [0;31m[error] [region 1] 1 on split with [56 32 48 48 48 48 48 48 48 48][0m
2022/03/17 21:20:15.900819 peer_msg_handler.go:678: [0;31m[error] [region 1] 1 propose split msg, msg: 1 4 local region: 1 4[0m
2022/03/17 21:20:15.941762 peer_msg_handler.go:166: [0;31m[error] [region 1] 1 apply split begin, split key [56 32 48 48 48 48 48 48 48 48], StartKey [52 32 48 48 48 48 48 48 48 51], EndKey [][0m
2022/03/17 21:20:15.941865 peer.go:41: [0;37m[info] region id:30 start_key:"4 00000003" end_key:"8 00000000" region_epoch:<conf_ver:1 version:5 > peers:<id:31 store_id:4 > peers:<id:32 store_id:5 > peers:<id:33 store_id:1 > peers:<id:34 store_id:2 > peers:<id:35 store_id:3 >  create peer with ID 33[0m
    test_test.go:44: failure
panic: key [52 32 48 48 48 48 48 48 48 51] is not in region id:1 start_key:"8 00000000" region_epoch:<conf_ver:1 version:5 > peers:<id:4 store_id:4 > peers:<id:5 store_id:5 > peers:<id:1 store_id:1 > peers:<id:2 store_id:2 > peers:<id:3 store_id:3 > 

goroutine 296 [running]:
github.com/pingcap-incubator/tinykv/kv/storage/raft_storage.(*RegionIterator).Seek(0xc1a518a220, {0xc17cac2bc0, 0x7, 0x10})
	/home/void/project/tinykv/kv/storage/raft_storage/region_reader.go:83 +0xec
github.com/pingcap-incubator/tinykv/kv/test_raftstore.(*Cluster).Scan(0xad7597, {0xc17ca422f0, 0xa, 0x10}, {0xc1a5193dc0, 0xa, 0x20})
	/home/void/project/tinykv/kv/test_raftstore/cluster.go:376 +0x322
github.com/pingcap-incubator/tinykv/kv/test_raftstore.GenericTest.func1(0x4, 0x0)
	/home/void/project/tinykv/kv/test_raftstore/test_test.go:233 +0x528
github.com/pingcap-incubator/tinykv/kv/test_raftstore.runClient(0x0, 0xc0043457d0, 0x8ba766, 0xc000279920)
	/home/void/project/tinykv/kv/test_raftstore/test_test.go:27 +0x78
created by github.com/pingcap-incubator/tinykv/kv/test_raftstore.SpawnClientsAndWait
	/home/void/project/tinykv/kv/test_raftstore/test_test.go:37 +0x89
FAIL	github.com/pingcap-incubator/tinykv/kv/test_raftstore	7.190s
FAIL
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestSplitUnreliable3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestSplitUnreliableRecover3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestSplitConfChangeSnapshotUnreliableRecover3B|| true
# GO111MODULE=on go test -v --count=1 --parallel=1 -p=1 ./kv/test_raftstore -run ^TestSplitConfChangeSnapshotUnreliableRecoverConcurrentPartition3B|| true
rm -rf /tmp/*test-raftstore*
